<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>toblog.dev</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/e7cfb2a.js" as="script"><link rel="preload" href="/_nuxt/cf78498.js" as="script"><link rel="preload" href="/_nuxt/e5a50fc.js" as="script"><link rel="preload" href="/_nuxt/d7fa962.js" as="script"><link rel="preload" href="/_nuxt/9414bce.js" as="script"><style data-vue-ssr-id="382a115c:0 0d8b0c4d:0 a57b151a:0">/*! tailwindcss v3.3.3 | MIT License | https://tailwindcss.com*/*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::after,::before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scroll-snap-strictness:proximity;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000}::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scroll-snap-strictness:proximity;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000}.static{position:static}.m-12{margin:3rem}.m-4{margin:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-10{margin-top:2.5rem;margin-bottom:2.5rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-3{margin-top:.75rem;margin-bottom:.75rem}.mr-4{margin-right:1rem}.flex{display:flex}.grid{display:grid}.h-6{height:1.5rem}.w-6{width:1.5rem}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.gap-4{gap:1rem}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-20>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(5rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.rounded-b{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.border-t-4{border-top-width:4px}.bg-blue-300{--tw-bg-opacity:1;background-color:rgb(147 197 253 / var(--tw-bg-opacity))}.bg-blue-700{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity))}.bg-cyan-300{--tw-bg-opacity:1;background-color:rgb(103 232 249 / var(--tw-bg-opacity))}.bg-cyan-700{--tw-bg-opacity:1;background-color:rgb(14 116 144 / var(--tw-bg-opacity))}.bg-emerald-300{--tw-bg-opacity:1;background-color:rgb(110 231 183 / var(--tw-bg-opacity))}.bg-emerald-700{--tw-bg-opacity:1;background-color:rgb(4 120 87 / var(--tw-bg-opacity))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity))}.bg-green-300{--tw-bg-opacity:1;background-color:rgb(134 239 172 / var(--tw-bg-opacity))}.bg-green-700{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity))}.bg-indigo-300{--tw-bg-opacity:1;background-color:rgb(165 180 252 / var(--tw-bg-opacity))}.bg-indigo-700{--tw-bg-opacity:1;background-color:rgb(67 56 202 / var(--tw-bg-opacity))}.bg-lime-300{--tw-bg-opacity:1;background-color:rgb(190 242 100 / var(--tw-bg-opacity))}.bg-orange-300{--tw-bg-opacity:1;background-color:rgb(253 186 116 / var(--tw-bg-opacity))}.bg-orange-700{--tw-bg-opacity:1;background-color:rgb(194 65 12 / var(--tw-bg-opacity))}.bg-pink-300{--tw-bg-opacity:1;background-color:rgb(249 168 212 / var(--tw-bg-opacity))}.bg-pink-700{--tw-bg-opacity:1;background-color:rgb(190 24 93 / var(--tw-bg-opacity))}.bg-purple-300{--tw-bg-opacity:1;background-color:rgb(216 180 254 / var(--tw-bg-opacity))}.bg-purple-700{--tw-bg-opacity:1;background-color:rgb(126 34 206 / var(--tw-bg-opacity))}.bg-rose-300{--tw-bg-opacity:1;background-color:rgb(253 164 175 / var(--tw-bg-opacity))}.bg-rose-700{--tw-bg-opacity:1;background-color:rgb(190 18 60 / var(--tw-bg-opacity))}.bg-sky-300{--tw-bg-opacity:1;background-color:rgb(125 211 252 / var(--tw-bg-opacity))}.bg-sky-700{--tw-bg-opacity:1;background-color:rgb(3 105 161 / var(--tw-bg-opacity))}.bg-teal-300{--tw-bg-opacity:1;background-color:rgb(94 234 212 / var(--tw-bg-opacity))}.bg-teal-700{--tw-bg-opacity:1;background-color:rgb(15 118 110 / var(--tw-bg-opacity))}.bg-violet-300{--tw-bg-opacity:1;background-color:rgb(196 181 253 / var(--tw-bg-opacity))}.bg-violet-700{--tw-bg-opacity:1;background-color:rgb(109 40 217 / var(--tw-bg-opacity))}.bg-yellow-300{--tw-bg-opacity:1;background-color:rgb(253 224 71 / var(--tw-bg-opacity))}.bg-yellow-700{--tw-bg-opacity:1;background-color:rgb(161 98 7 / var(--tw-bg-opacity))}.fill-current{fill:currentColor}.p-12{padding:3rem}.p-4{padding:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-16{padding-top:4rem;padding-bottom:4rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-5xl{font-size:3rem;line-height:1}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-thin{font-weight:100}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1),0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.nuxt-content-highlight{background:#f9f9f9;color:#242424;padding:14px;border:1px solid #e5e5e5;border-radius:4px}.language-text{background:#f9f9f9!important}.nuxt-content p code{background:#efefef}.nuxt-content p{text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;display:block;margin-block-start:1em;margin-block-end:1em;margin-inline-start:0;margin-inline-end:0;color:#242424;font-style:normal;word-break:break-word;font-weight:400;letter-spacing:-.003em;line-height:28px;font-size:18px;margin-bottom:-.46em;margin-top:1.56em}.nuxt-content a{background:#efefef;color:#333;-webkit-text-decoration:underline dashed;text-decoration:underline dashed}.nuxt-content a:hover{background:#333;color:#efefef;-webkit-text-decoration:underline dashed;text-decoration:underline dashed}.nuxt-content ul{list-style-position:inside}.nuxt-content li{list-style-type:square}.nuxt-content h2{color:#242424;font-weight:600;font-size:20px}.nuxt-content h3,.nuxt-content h4{color:#242424;font-size:18px;font-weight:600;border-left:3px solid #333;padding-left:10px}@media (min-width:768px){.md\:m-12{margin:3rem}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:p-12{padding:3rem}.md\:py-40{padding-top:10rem;padding-bottom:10rem}.md\:text-right{text-align:right}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}.md\:text-base{font-size:1rem;line-height:1.5rem}.md\:font-medium{font-weight:500}}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}</style><link rel="preload" href="/_nuxt/static/1699539594/2023-11-09-mapping-out-doctrine-association-mapping/state.js" as="script"><link rel="preload" href="/_nuxt/static/1699539594/2023-11-09-mapping-out-doctrine-association-mapping/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1699539594/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><article class="m-4 md:m-12"><div class="grid md:grid-cols-2 gap-4"><div class="text-left font-medium"><a href>↵ Back</a></div> <div class="text-center md:text-right"><p class="md:font-medium text-sm md:text-base">Published November 9, 2023, last updated November 9, 2023</p></div></div> <header class="p-4 py-16 md:p-12 md:py-40 text-center text-white my-10 space-y-20 bg-green-300"><div class="max-w-4xl mx-auto"><h1 class="text-xl md:text-4xl font-thin">Mapping out Doctrine association mapping</h1></div></header> <!----> <div class="max-w-2xl mx-auto space-y-6 nuxt-content"><p>Association mapping in Doctrine is one of those topics that at its core is quite a simple concept, but in practice can be confusing and off-putting.</p>
<p>This likely stems from table relations and related concepts of foreign keys and joins being a somewhat difficult thing to reason about already without then adding in the additional workload of working in the space of an entity object graph while simultaneously mentaly mapping back to those relational concepts.</p>
<p>Throw in some new terminology in the form of unidirectional and bidirectional associations, owning side, inversed by and mapped by, and it all seems scarier than it is.</p>
<h2 id="understanding-doctrine-associations"><a href="#understanding-doctrine-associations" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Understanding Doctrine Associations</h2>
<p>Let's start by working backwards, suppose we have the following schema that we want to hydrate into entity objects.</p>

<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>author(id, name)
book(id, author_id, title)
</code></pre></div>
<p>In Doctrine, we describe the relationship in the direction from the Entity we're talking about toward the entity it's related to, so if we're talking about an Author, this is a <code>OneToMany</code> association, because one Author has many Books as we can tell from the foreign key on book. If we were talking about Books, we would say it has a <code>ManyToOne</code> because we can have many Books that each point back to only one Author.</p>
<p>So let's now create actual Doctrine entities to bring our simple relational schema into the object world.</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>#[ORM\Entity(repositoryClass: AuthorRepository::class)]
class Author
{
    #[ORM\Id]
    #[ORM\GeneratedValue]
    #[ORM\Column]
    private ?int $id = null;

    #[ORM\Column(length: 255)]
    private ?string $name = null;

    // We read from left to right from the entity we're looking at, so OneToMany here means One Author to Many Books.
    // Also note that on the Entity we have a reference back to our Books, where as in our table Author doesn't know about Books.
    #[ORM\OneToMany(mappedBy: 'author', targetEntity: Book::class)]
    private Collection $books;
}
</code></pre></div>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>#[ORM\Entity(repositoryClass: BookRepository::class)]
class Book
{
    #[ORM\Id]
    #[ORM\GeneratedValue]
    #[ORM\Column]
    private ?int $id = null;

    #[ORM\Column(length: 255)]
    private ?string $title = null;

    // Again, we're looking at Book, so Many Books have one Author.
    #[ORM\ManyToOne(inversedBy: 'books')]
    private ?Author $author = null;
}
</code></pre></div>
<p>Hopefully the above is more or less what you were expecting to see for our entities given the small schema we designed above. If we weren't working with an ORM we'd have likely created similar looking classes at some point to represent the data in each of our author and book tables.</p>
<h2 id="bidirectional-and-unidirectional-associations"><a href="#bidirectional-and-unidirectional-associations" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Bidirectional and Unidirectional Associations</h2>
<p>The one thing that might stick out as strange to you at this point, is that in our Author entity we have a reference back to Books. But our Author table doesn't have any kind of way of knowing about Books.</p>
<p>In Doctrine, this is called a bidirectional association, meaning simply that we can get the associated objects from either side of the association.</p>
<p>This is an optional step that we could have left off, but by adding this column to our Author we can now easily access all our Author's Books given any instance of Author.</p>
<p>If we were to remove this property from Author, we would have then created a unidirectional association, meaning we could only get a related Author from a Book, and no Books from an Author.</p>
<p>This concept of a bidirectional association is a convenience given to us by the fact we're working in the object graph space now and not the relational space, so when doctrine retrieves our related data from the database it can setup references for us so we can later have the ease of making calls like <code>$author->getBooks()</code>.</p>
<p>So let's look at the actual DDL/SQL that Doctrine gives us for creating a concrete schema from the above.</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>CREATE TABLE `author` (
  `id` int NOT NULL AUTO_INCREMENT,
  `name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  PRIMARY KEY (`id`)
)
</code></pre></div>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>CREATE TABLE `book` (
  `id` int NOT NULL AUTO_INCREMENT,
  `author_id` int DEFAULT NULL,
  `title` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `IDX_CBE5A331F675F31B` (`author_id`),
  CONSTRAINT `FK_CBE5A331F675F31B` FOREIGN KEY (`author_id`) REFERENCES `author` (`id`)
)
</code></pre></div>
<p>These were created with <code>symfony console doctrine:schema:update --dump-sql</code></p>
<p>So we've gone from our human readable schema definition, to entities we can use to interact with those data in the object world, back to actual DDL/SQL.</p>
<h2 id="ownership-inversedby-and-mappedby"><a href="#ownership-inversedby-and-mappedby" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Ownership, inversedBy and mappedBy</h2>
<p>So why is it optional to have a reference back from Author to Books and not the other way around? Because our Book is the <em>owning</em> side. This might seem counter intuitive and is likely another reason the Doctrine learning curve is a little steep.</p>
<p>Our domain logic and logic generally says that an Author owns their Books, but in Doctrine our associations have nothing to do with our domain logic. The owning side is the entity that contains the <code>ManyToOne</code> relation and/or that has the foreign key.</p>
<p>Generally, the entity that defines a <code>ManyToOne</code> on itself is always the owning side, the opposite is also true that an entity that defines <code>OneToMany</code> is <em>not</em> the owning side or is the 'inverse' side.</p>
<p>And that is where we get the terminology <code>inversedBy</code> as seen on the Book entity above, repeated below for clarity:</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>#[ORM\ManyToOne(inversedBy: 'books')]
private ?Author $author = null;
</code></pre></div>
<p>I think of this as the inverse of being an owner is being owned. So our Book is the owner, the inverse side of the ownership relationship is Author. <code>books</code> refers to the field on Author that references our <code>Many</code> Books.</p>
<p>On the Author side of the association, the books field is annotated with <code>mappedBy</code>:</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>#[ORM\OneToMany(mappedBy: 'author', targetEntity: Book::class)]
private Collection $books;
</code></pre></div>
<p>The terminology <code>mappedBy</code> goes back to the concept of ownership. In relational terms, our Author has no way of knowing about its books on its own, so in our object graph we need a way of <code>mapping</code> back to our Books. We can read this annotation as our <code>books</code> property is mapped by the <code>author</code> property on <code>Book</code>.</p>
<p>If we didn't setup a bidirectional association, then we wouldn't need to worry about <code>inversedBy</code> and <code>mappedBy</code> at all, these concepts relate <em>only</em> to bidirectional associations.</p>
<h2 id="join-columns"><a href="#join-columns" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Join Columns</h2>
<p>For the association above we don't need to explictly write out a <code>JoinColumn</code> annotation because Doctrine has enough information to find its foreign key that we could otherwise specify in <code>JoinColumn(referencedColumnName:)</code> and importantly because the association is nullable.</p>
<p>If we change the association above to not be nullable, then we add the JoinColumn <code>#[ORM\JoinColumn(nullable: false)]</code>.</p>
<h2 id="associations"><a href="#associations" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Associations</h2>
<p>The <a href="https://www.doctrine-project.org/projects/doctrine-orm/en/2.16/reference/association-mapping.html" rel="nofollow noopener noreferrer" target="_blank">Doctrine documentation for association mapping</a> lists out all of the following association types:</p>
<ul>
<li>Many-To-One, Unidirectional</li>
<li>One-To-One, Unidirectional</li>
<li>One-To-One, Bidirectional</li>
<li>One-To-One, Self-referencing</li>
<li>One-To-Many, Bidirectional</li>
<li>One-To-Many, Unidirectional with Join Table</li>
<li>One-To-Many, Self-referencing</li>
<li>Many-To-Many, Unidirectional</li>
<li>Many-To-Many, Bidirectional</li>
<li>Many-To-Many, Self-referencing</li>
</ul>
<p>Let's simplify that list a bit so we can have a manageable working knowledge of it. We already know that bidirectional and unidirectional is just giving us the convenience of referencing the inversed side of an association, so we can leave that to one side and know that it can be added to each type of association as needed.</p>
<p>Self-referencing just means that an entity is referencing itself rather than another type of entity. The best example is a Category entity that has subcategories that are also of type Category. So again we can put that to one side seeing as it's really just a way of saying we're referencing the same Entity from that Entity, and that leaves us with:</p>
<ul>
<li>Many-To-One</li>
<li>One-To-One</li>
<li>One-To-Many</li>
<li>Many-To-Many</li>
</ul>
<p><code>OneToMany</code> is just the inverse of <code>ManyToOne</code> which we've seen, so it's really just the other side of a <code>ManyToOne</code>. So we don't need to let that take up valuable cognitive space, so let's work with:</p>
<ul>
<li>Many-To-One</li>
<li>One-To-One</li>
<li>Many-To-Many</li>
</ul>
<p>When we compare the difference between <code>ManyToOne</code> and <code>OneToOne</code> which we can do by changing the relations on our existing <code>Author</code> <code>Book</code> association.</p>
<p>So this:</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>#[ORM\ManyToOne]
private ?Author $author = null;
</code></pre></div>
<p>Becomes:</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>#[ORM\OneToOne]
private ?Author $author = null;
</code></pre></div>
<p>With that in place, the only change that <code>symfony console doctrine:schema:update --dump-sql</code> wants to make is:</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>ALTER TABLE book DROP INDEX IDX_CBE5A331F675F31B, ADD UNIQUE INDEX UNIQ_CBE5A331F675F31B (author_id);
</code></pre></div>
<p>Meaning the only difference between a <code>ManyToOne</code> and a <code>OneToOne</code> is a <code>UNIQUE INDEX </code> which is going to enforce the one to one relationship. So we can think of a <code>OneToOne</code> as a <code>ManyToOne</code> with that extra restriction.</p>
<p>So for simplicity's sake, we can think of the associations available to us as...</p>
<h3 id="1-many-to-one"><a href="#1-many-to-one" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>1. Many-To-One</h3>
<ul>
<li>Optional unique index to force the association to be <code>OneToOne</code></li>
<li>Unidirectional</li>
<li>Bidirectional</li>
<li>Self-referencing</li>
</ul>
<h3 id="2-many-to-many"><a href="#2-many-to-many" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>2. Many-To-Many</h3>
<ul>
<li>Unidirectional</li>
<li>Bidirectional</li>
<li>Self-referencing</li>
</ul></div></article></div></div><script defer src="/_nuxt/static/1699539594/2023-11-09-mapping-out-doctrine-association-mapping/state.js"></script><script src="/_nuxt/e7cfb2a.js" defer></script><script src="/_nuxt/9414bce.js" defer></script><script src="/_nuxt/cf78498.js" defer></script><script src="/_nuxt/e5a50fc.js" defer></script><script src="/_nuxt/d7fa962.js" defer></script>
  </body>
</html>
