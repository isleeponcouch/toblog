<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>toblog.dev</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/e3b6090.js" as="script"><link rel="preload" href="/_nuxt/cf78498.js" as="script"><link rel="preload" href="/_nuxt/e5a50fc.js" as="script"><link rel="preload" href="/_nuxt/fb3670b.js" as="script"><link rel="preload" href="/_nuxt/9414bce.js" as="script"><style data-vue-ssr-id="382a115c:0 0d8b0c4d:0 a57b151a:0">/*! tailwindcss v3.3.3 | MIT License | https://tailwindcss.com*/*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::after,::before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scroll-snap-strictness:proximity;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000}::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scroll-snap-strictness:proximity;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000}.static{position:static}.m-1{margin:.25rem}.m-12{margin:3rem}.m-4{margin:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:.25rem;margin-bottom:.25rem}.my-10{margin-top:2.5rem;margin-bottom:2.5rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-3{margin-top:.75rem;margin-bottom:.75rem}.mr-4{margin-right:1rem}.flex{display:flex}.grid{display:grid}.h-6{height:1.5rem}.w-6{width:1.5rem}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.gap-4{gap:1rem}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-20>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(5rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.rounded-b{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.border-t-4{border-top-width:4px}.bg-blue-300{--tw-bg-opacity:1;background-color:rgb(147 197 253 / var(--tw-bg-opacity))}.bg-blue-700{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity))}.bg-cyan-300{--tw-bg-opacity:1;background-color:rgb(103 232 249 / var(--tw-bg-opacity))}.bg-cyan-700{--tw-bg-opacity:1;background-color:rgb(14 116 144 / var(--tw-bg-opacity))}.bg-emerald-300{--tw-bg-opacity:1;background-color:rgb(110 231 183 / var(--tw-bg-opacity))}.bg-emerald-700{--tw-bg-opacity:1;background-color:rgb(4 120 87 / var(--tw-bg-opacity))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity))}.bg-green-300{--tw-bg-opacity:1;background-color:rgb(134 239 172 / var(--tw-bg-opacity))}.bg-green-700{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity))}.bg-indigo-300{--tw-bg-opacity:1;background-color:rgb(165 180 252 / var(--tw-bg-opacity))}.bg-indigo-700{--tw-bg-opacity:1;background-color:rgb(67 56 202 / var(--tw-bg-opacity))}.bg-lime-300{--tw-bg-opacity:1;background-color:rgb(190 242 100 / var(--tw-bg-opacity))}.bg-orange-300{--tw-bg-opacity:1;background-color:rgb(253 186 116 / var(--tw-bg-opacity))}.bg-orange-700{--tw-bg-opacity:1;background-color:rgb(194 65 12 / var(--tw-bg-opacity))}.bg-pink-300{--tw-bg-opacity:1;background-color:rgb(249 168 212 / var(--tw-bg-opacity))}.bg-pink-700{--tw-bg-opacity:1;background-color:rgb(190 24 93 / var(--tw-bg-opacity))}.bg-purple-300{--tw-bg-opacity:1;background-color:rgb(216 180 254 / var(--tw-bg-opacity))}.bg-purple-700{--tw-bg-opacity:1;background-color:rgb(126 34 206 / var(--tw-bg-opacity))}.bg-rose-300{--tw-bg-opacity:1;background-color:rgb(253 164 175 / var(--tw-bg-opacity))}.bg-rose-700{--tw-bg-opacity:1;background-color:rgb(190 18 60 / var(--tw-bg-opacity))}.bg-sky-300{--tw-bg-opacity:1;background-color:rgb(125 211 252 / var(--tw-bg-opacity))}.bg-sky-700{--tw-bg-opacity:1;background-color:rgb(3 105 161 / var(--tw-bg-opacity))}.bg-teal-300{--tw-bg-opacity:1;background-color:rgb(94 234 212 / var(--tw-bg-opacity))}.bg-teal-700{--tw-bg-opacity:1;background-color:rgb(15 118 110 / var(--tw-bg-opacity))}.bg-violet-300{--tw-bg-opacity:1;background-color:rgb(196 181 253 / var(--tw-bg-opacity))}.bg-violet-700{--tw-bg-opacity:1;background-color:rgb(109 40 217 / var(--tw-bg-opacity))}.bg-yellow-300{--tw-bg-opacity:1;background-color:rgb(253 224 71 / var(--tw-bg-opacity))}.bg-yellow-700{--tw-bg-opacity:1;background-color:rgb(161 98 7 / var(--tw-bg-opacity))}.fill-current{fill:currentColor}.p-12{padding:3rem}.p-4{padding:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-16{padding-top:4rem;padding-bottom:4rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-5xl{font-size:3rem;line-height:1}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-thin{font-weight:100}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1),0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.nuxt-content-highlight{background:#f9f9f9;color:#242424;padding:14px;border:1px solid #e5e5e5;border-radius:4px}.language-text{background:#f9f9f9!important}.nuxt-content p code{background:#efefef}.nuxt-content p{text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;display:block;margin-block-start:1em;margin-block-end:1em;margin-inline-start:0;margin-inline-end:0;color:#242424;font-style:normal;word-break:break-word;font-weight:400;letter-spacing:-.003em;line-height:28px;font-size:18px;margin-bottom:-.46em;margin-top:1.56em}.nuxt-content a{background:#efefef;color:#333;-webkit-text-decoration:underline dashed;text-decoration:underline dashed}.nuxt-content a:hover{background:#333;color:#efefef;-webkit-text-decoration:underline dashed;text-decoration:underline dashed}.nuxt-content ul{list-style-position:inside}.nuxt-content li{list-style-type:square}.nuxt-content h2{color:#242424;font-weight:600;font-size:20px}.nuxt-content h3,.nuxt-content h4{color:#242424;font-size:18px;font-weight:600;border-left:3px solid #333;padding-left:10px}@media (min-width:768px){.md\:m-12{margin:3rem}.md\:my-3{margin-top:.75rem;margin-bottom:.75rem}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:p-12{padding:3rem}.md\:py-40{padding-top:10rem;padding-bottom:10rem}.md\:text-right{text-align:right}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}.md\:text-base{font-size:1rem;line-height:1.5rem}.md\:font-medium{font-weight:500}}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}</style><link rel="preload" href="/_nuxt/static/1706238215/2024-01-25-atomdash-to-apple-vision-pro-vision-os/state.js" as="script"><link rel="preload" href="/_nuxt/static/1706238215/2024-01-25-atomdash-to-apple-vision-pro-vision-os/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1706238215/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><article class="m-4 md:m-12"><div class="grid md:grid-cols-2 gap-4"><div class="text-left font-medium"><a href>↵ Back</a></div> <div class="text-center md:text-right"><p class="md:font-medium text-sm md:text-base">Published January 25, 2024, last updated January 25, 2024</p></div></div> <header class="p-4 py-16 md:p-12 md:py-40 text-center text-white my-10 space-y-20 bg-blue-300"><div class="max-w-4xl mx-auto"><h1 class="text-xl md:text-4xl font-thin">Releasing my chemistry tutor app Atomdash natively for visionOS</h1></div></header> <!----> <div class="max-w-2xl mx-auto space-y-6 nuxt-content"><p>In just over a week from now the Apple Vision Pro will launch and along with it version 1.0 of visionOS. This is my account of the process of getting my chemistry tutor app Atomdash ready for this new platform.</p>
<p>From the outset, let me just say, this post will be short. Like a lot of developers, my app ran on the Vision Pro simulator pretty well out of the box in its 'Designed for iPad' state.</p>
<p>If I were happy to accept a bit of ugly UI and a clunky user experience, I more or less could've just let it go out like that.</p>
<p>But with a relatively small amount of effort, I can have Atomdash native to visionOS from day one.</p>
<img src="/images/posts/atomdash-visionos-1.png" alt="Atomdash chemistry tutor running in the Apple Vision Pro simulator" class="mx-auto">
<h2 id="design-for-ipadiphone-vs-apple-vision"><a href="#design-for-ipadiphone-vs-apple-vision" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Design for iPad/iPhone vs. Apple Vision</h2>
<p>When you open Xcode 15.2, Support Destinations now shows Apple Vision (Designed for iPad) or Apple Vision (Designed for iPad) as a supported destination for your target straight out of the box. If you don't do any specific work to support Apple Vision, your app will run this way on visionOS. If you choose to go with this option, your app will show as designed for iPhone/iPad and retain the normal round square app icon. visionOS natives will have a layered circle icon.</p>
<img src="/images/posts/atomdash-visionos-2.png" alt="Atomdash chemistry tutor running in the Apple Vision Pro simulator" class="mx-auto">
<h2 id="the-process"><a href="#the-process" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>The process</h2>
<p>To support visionOS natively, we just add the 'Apple Vision' destination, which will replace the 'Apple Vision (Designed for iPad)' destination. From there it's a matter of going through each screen of your app adjusting the UI to work with visionOS and rearranging your app structure to feel more like a visionOS native.</p>
<img src="/images/posts/atomdash-visionos-3.png" alt="Atomdash chemistry tutor running in the Apple Vision Pro simulator" class="mx-auto">
<h3 id="hoisting-state"><a href="#hoisting-state" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Hoisting State</h3>
<p>In my experience, and I imagine the experience will be similar for most developers, the process of supporting visionOS natively could mostly be described as hoisting state to the <code>@main</code> level where the main <code>OurApp: App</code> struct is and adding <code>WindowGroup</code>s to house UI that was either a <code>popover</code> or <code>sheet</code> in the iOS and iPadOS versions.</p>
<p>This will mean refactoring your codebase so those UI elements can stand alone if they don't already. Then adding them to a <code>WindowGroup</code> with an <code>id</code>, hoisting any state i.e. <code>ObservableObject</code>s associated with those UI up to the <code>@main</code> level and then replacing any calls to <code>popover</code> etc. to <code>openWindow(id: "id")</code>.</p>
<p>To get access to openWindow and dismissWindow, bring them in from the environment:</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>@Environment(\.openWindow) private var openWindow
@Environment(\.dismissWindow) private var dismissWindow
</code></pre></div>
<p>If you target less than iOS 17 in your current iOS target, you can wrap those in the <code>#if os()</code> macro:</p>
<div class="nuxt-content-highlight"><pre class="language-text line-numbers"><code>#if os(visionOS)
// do a visionOS thing 🤘🏻
#endif
</code></pre></div>
<img src="/images/posts/atomdash-visionos-4.png" alt="Atomdash chemistry tutor running in the Apple Vision Pro simulator" class="mx-auto">
<h3 id="ui"><a href="#ui" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>UI</h3>
<p>In the case of Atomdash, getting the UI ready for visionOS was a combination of removing background modifiers so that UI elements would sit on the translucent material backgrounds of the visionOS surface windows, specifically adding <code>.regularMaterial</code> background modifiers to other components, removing coloured texts, and resizing things.</p>
<p>I used preprocessor macros because I only had a small handful of UI changes to make. If I had to make more significant changes, or if you do, I would go down the path of creating a separate target for visionOS. Atomdash is reasonably well setup for this kind of architecture with most things already existing in their own frameworks. But in my case, it would have been overkill to create a new target.</p>
<p>Support for tvOS and macOS are on the roadmap for Atomdash, when I get to this work it might make sense to swap out the preprocessor macros for checking for <a href="https://developer.apple.com/documentation/visionos/presenting-windows-and-spaces" rel="nofollow noopener noreferrer" target="_blank">multiple scene support</a> instead.</p>
<img src="/images/posts/atomdash-visionos-5.png" alt="Atomdash chemistry tutor running in the Apple Vision Pro simulator" class="mx-auto">
<h3 id="a-note-on-defaultsizewidthheightdepthin"><a href="#a-note-on-defaultsizewidthheightdepthin" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>A note on <code>.defaultSize(width:height:depth:in:)</code></h3>
<p>Currently the official documentation says this modifier is only available on volumetric windows <code>.windowStyle(.volumetric)</code> but this modifier does work on plain windows as well. Which seems absolutely necessary.</p>
<h3 id="icon"><a href="#icon" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Icon</h3>
<p>visionOS like tvOS requires a layered icon. For visionOS there are 3 layers. Unfortunately the Atomdash logo isn't easily split into layers, but I got a build error trying to use only a single layer. I tried with 3 layers all of the flattened logo image and that worked and got through approval. Not an ideal solution, but it will do for now.</p>
<h3 id="app-store-submission"><a href="#app-store-submission" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>App Store submission</h3>
<p>This really isn't any different to deploying to any other platform. There are 2 minor gotchas</p>
<ol>
<li>Binary not showing up in the builds for visionOS</li>
</ol>
<p>Even though we've added the visionOS supported destination, the binary defaults to the iOS base SDK. Change this in the build settings under <code>Architectures -> Base SDK</code> to visionOS.</p>
<ol start="2">
<li>Screenshots</li>
</ol>
<p>The App Store requires visionOS screenshots at <code>3840 . 2160</code> but the visionOS simulator takes screenshots at <code>2732 . 2048</code>. I just brought my screenshots into Photoshop and enlarged them without messing up the aspect ratio. My app was approved so this seems to be acceptable.</p>
<img src="/images/posts/atomdash-visionos-6.png" alt="Atomdash chemistry tutor running in the Apple Vision Pro simulator" class="mx-auto">
<h2 id="thats-it"><a href="#thats-it" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>That's it</h2>
<p>Shortly after starting to write this post, Atomdash for visionOS was approved for the App Store. The first Apple Vision Pros and visionOS 1.0 will be in the hands of real users in just over a week on Feb 2nd and Atomdash will be available as a native app in the new App Store on day one, which I'm thrilled about.</p>
<p>I'll continue to improve my support for the platform in the coming months.</p></div></article></div></div><script defer src="/_nuxt/static/1706238215/2024-01-25-atomdash-to-apple-vision-pro-vision-os/state.js"></script><script src="/_nuxt/e3b6090.js" defer></script><script src="/_nuxt/9414bce.js" defer></script><script src="/_nuxt/cf78498.js" defer></script><script src="/_nuxt/e5a50fc.js" defer></script><script src="/_nuxt/fb3670b.js" defer></script>
  </body>
</html>
