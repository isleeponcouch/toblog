<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><title>Brisbane based software engineer's blog about Swift, Kotlin, PHP, and croissants.</title><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/386cd7d.js" as="script"><link rel="preload" href="/_nuxt/43ca708.js" as="script"><link rel="preload" href="/_nuxt/3e08e2f.js" as="script"><link rel="preload" href="/_nuxt/3a249ae.js" as="script"><link rel="preload" href="/_nuxt/be996ed.js" as="script"><style data-vue-ssr-id="d706d280:0 15f0552d:0 49569972:0">*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 transparent;--tw-ring-shadow:0 0 transparent;--tw-shadow:0 0 transparent;--tw-shadow-colored:0 0 transparent;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 transparent;--tw-ring-shadow:0 0 transparent;--tw-shadow:0 0 transparent;--tw-shadow-colored:0 0 transparent;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]:where(:not([hidden=until-found])){display:none}.static{position:static}.m-1{margin:.25rem}.m-4{margin:1rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-bottom:.25rem;margin-top:.25rem}.my-10{margin-bottom:2.5rem;margin-top:2.5rem}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-3{margin-bottom:.75rem;margin-top:.75rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mr-4{margin-right:1rem}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.h-6{height:1.5rem}.w-6{width:1.5rem}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.gap-4{gap:1rem}.space-y-20>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:0;margin-bottom:calc(5rem*var(--tw-space-y-reverse));margin-top:5rem;margin-top:calc(5rem*(1 - var(--tw-space-y-reverse)))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:0;margin-bottom:calc(1.5rem*var(--tw-space-y-reverse));margin-top:1.5rem;margin-top:calc(1.5rem*(1 - var(--tw-space-y-reverse)))}.rounded{border-radius:.25rem}.rounded-b{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem}.border-t-4{border-top-width:4px}.bg-blue-300{--tw-bg-opacity:1;background-color:#93c5fd;background-color:rgba(147,197,253,var(--tw-bg-opacity,1))}.bg-blue-600{--tw-bg-opacity:1;background-color:#2563eb;background-color:rgba(37,99,235,var(--tw-bg-opacity,1))}.bg-blue-700{--tw-bg-opacity:1;background-color:#1d4ed8;background-color:rgba(29,78,216,var(--tw-bg-opacity,1))}.bg-blue-800{--tw-bg-opacity:1;background-color:#1e40af;background-color:rgba(30,64,175,var(--tw-bg-opacity,1))}.bg-cyan-300{--tw-bg-opacity:1;background-color:#67e8f9;background-color:rgba(103,232,249,var(--tw-bg-opacity,1))}.bg-cyan-600{--tw-bg-opacity:1;background-color:#0891b2;background-color:rgba(8,145,178,var(--tw-bg-opacity,1))}.bg-cyan-700{--tw-bg-opacity:1;background-color:#0e7490;background-color:rgba(14,116,144,var(--tw-bg-opacity,1))}.bg-cyan-800{--tw-bg-opacity:1;background-color:#155e75;background-color:rgba(21,94,117,var(--tw-bg-opacity,1))}.bg-emerald-300{--tw-bg-opacity:1;background-color:#6ee7b7;background-color:rgba(110,231,183,var(--tw-bg-opacity,1))}.bg-emerald-600{--tw-bg-opacity:1;background-color:#059669;background-color:rgba(5,150,105,var(--tw-bg-opacity,1))}.bg-emerald-700{--tw-bg-opacity:1;background-color:#047857;background-color:rgba(4,120,87,var(--tw-bg-opacity,1))}.bg-emerald-800{--tw-bg-opacity:1;background-color:#065f46;background-color:rgba(6,95,70,var(--tw-bg-opacity,1))}.bg-fuchsia-600{--tw-bg-opacity:1;background-color:#c026d3;background-color:rgba(192,38,211,var(--tw-bg-opacity,1))}.bg-gray-300{--tw-bg-opacity:1;background-color:#d1d5db;background-color:rgba(209,213,219,var(--tw-bg-opacity,1))}.bg-gray-600{--tw-bg-opacity:1;background-color:#4b5563;background-color:rgba(75,85,99,var(--tw-bg-opacity,1))}.bg-gray-700{--tw-bg-opacity:1;background-color:#374151;background-color:rgba(55,65,81,var(--tw-bg-opacity,1))}.bg-gray-800{--tw-bg-opacity:1;background-color:#1f2937;background-color:rgba(31,41,55,var(--tw-bg-opacity,1))}.bg-green-300{--tw-bg-opacity:1;background-color:#86efac;background-color:rgba(134,239,172,var(--tw-bg-opacity,1))}.bg-green-600{--tw-bg-opacity:1;background-color:#16a34a;background-color:rgba(22,163,74,var(--tw-bg-opacity,1))}.bg-green-700{--tw-bg-opacity:1;background-color:#15803d;background-color:rgba(21,128,61,var(--tw-bg-opacity,1))}.bg-green-800{--tw-bg-opacity:1;background-color:#166534;background-color:rgba(22,101,52,var(--tw-bg-opacity,1))}.bg-indigo-300{--tw-bg-opacity:1;background-color:#a5b4fc;background-color:rgba(165,180,252,var(--tw-bg-opacity,1))}.bg-indigo-600{--tw-bg-opacity:1;background-color:#4f46e5;background-color:rgba(79,70,229,var(--tw-bg-opacity,1))}.bg-indigo-700{--tw-bg-opacity:1;background-color:#4338ca;background-color:rgba(67,56,202,var(--tw-bg-opacity,1))}.bg-indigo-800{--tw-bg-opacity:1;background-color:#3730a3;background-color:rgba(55,48,163,var(--tw-bg-opacity,1))}.bg-lime-300{--tw-bg-opacity:1;background-color:#bef264;background-color:rgba(190,242,100,var(--tw-bg-opacity,1))}.bg-orange-300{--tw-bg-opacity:1;background-color:#fdba74;background-color:rgba(253,186,116,var(--tw-bg-opacity,1))}.bg-orange-600{--tw-bg-opacity:1;background-color:#ea580c;background-color:rgba(234,88,12,var(--tw-bg-opacity,1))}.bg-orange-700{--tw-bg-opacity:1;background-color:#c2410c;background-color:rgba(194,65,12,var(--tw-bg-opacity,1))}.bg-orange-800{--tw-bg-opacity:1;background-color:#9a3412;background-color:rgba(154,52,18,var(--tw-bg-opacity,1))}.bg-pink-300{--tw-bg-opacity:1;background-color:#f9a8d4;background-color:rgba(249,168,212,var(--tw-bg-opacity,1))}.bg-pink-600{--tw-bg-opacity:1;background-color:#db2777;background-color:rgba(219,39,119,var(--tw-bg-opacity,1))}.bg-pink-700{--tw-bg-opacity:1;background-color:#be185d;background-color:rgba(190,24,93,var(--tw-bg-opacity,1))}.bg-pink-800{--tw-bg-opacity:1;background-color:#9d174d;background-color:rgba(157,23,77,var(--tw-bg-opacity,1))}.bg-purple-300{--tw-bg-opacity:1;background-color:#d8b4fe;background-color:rgba(216,180,254,var(--tw-bg-opacity,1))}.bg-purple-600{--tw-bg-opacity:1;background-color:#9333ea;background-color:rgba(147,51,234,var(--tw-bg-opacity,1))}.bg-purple-700{--tw-bg-opacity:1;background-color:#7e22ce;background-color:rgba(126,34,206,var(--tw-bg-opacity,1))}.bg-purple-800{--tw-bg-opacity:1;background-color:#6b21a8;background-color:rgba(107,33,168,var(--tw-bg-opacity,1))}.bg-rose-300{--tw-bg-opacity:1;background-color:#fda4af;background-color:rgba(253,164,175,var(--tw-bg-opacity,1))}.bg-rose-600{--tw-bg-opacity:1;background-color:#e11d48;background-color:rgba(225,29,72,var(--tw-bg-opacity,1))}.bg-rose-700{--tw-bg-opacity:1;background-color:#be123c;background-color:rgba(190,18,60,var(--tw-bg-opacity,1))}.bg-rose-800{--tw-bg-opacity:1;background-color:#9f1239;background-color:rgba(159,18,57,var(--tw-bg-opacity,1))}.bg-sky-300{--tw-bg-opacity:1;background-color:#7dd3fc;background-color:rgba(125,211,252,var(--tw-bg-opacity,1))}.bg-sky-600{--tw-bg-opacity:1;background-color:#0284c7;background-color:rgba(2,132,199,var(--tw-bg-opacity,1))}.bg-sky-700{--tw-bg-opacity:1;background-color:#0369a1;background-color:rgba(3,105,161,var(--tw-bg-opacity,1))}.bg-sky-800{--tw-bg-opacity:1;background-color:#075985;background-color:rgba(7,89,133,var(--tw-bg-opacity,1))}.bg-teal-300{--tw-bg-opacity:1;background-color:#5eead4;background-color:rgba(94,234,212,var(--tw-bg-opacity,1))}.bg-teal-600{--tw-bg-opacity:1;background-color:#0d9488;background-color:rgba(13,148,136,var(--tw-bg-opacity,1))}.bg-teal-700{--tw-bg-opacity:1;background-color:#0f766e;background-color:rgba(15,118,110,var(--tw-bg-opacity,1))}.bg-teal-800{--tw-bg-opacity:1;background-color:#115e59;background-color:rgba(17,94,89,var(--tw-bg-opacity,1))}.bg-violet-300{--tw-bg-opacity:1;background-color:#c4b5fd;background-color:rgba(196,181,253,var(--tw-bg-opacity,1))}.bg-violet-600{--tw-bg-opacity:1;background-color:#7c3aed;background-color:rgba(124,58,237,var(--tw-bg-opacity,1))}.bg-violet-700{--tw-bg-opacity:1;background-color:#6d28d9;background-color:rgba(109,40,217,var(--tw-bg-opacity,1))}.bg-yellow-300{--tw-bg-opacity:1;background-color:#fde047;background-color:rgba(253,224,71,var(--tw-bg-opacity,1))}.bg-yellow-600{--tw-bg-opacity:1;background-color:#ca8a04;background-color:rgba(202,138,4,var(--tw-bg-opacity,1))}.bg-yellow-700{--tw-bg-opacity:1;background-color:#a16207;background-color:rgba(161,98,7,var(--tw-bg-opacity,1))}.bg-yellow-800{--tw-bg-opacity:1;background-color:#854d0e;background-color:rgba(133,77,14,var(--tw-bg-opacity,1))}.fill-current{fill:currentColor}.p-1{padding:.25rem}.p-2{padding:.5rem}.p-4{padding:1rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-16{padding-bottom:4rem;padding-top:4rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-thin{font-weight:100}.text-gray-300{--tw-text-opacity:1;color:#d1d5db;color:rgba(209,213,219,var(--tw-text-opacity,1))}.text-white{--tw-text-opacity:1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity,1))}.underline{text-decoration-line:underline}.decoration-blue-600{text-decoration-color:#2563eb}.decoration-cyan-600{text-decoration-color:#0891b2}.decoration-emerald-600{text-decoration-color:#059669}.decoration-fuchsia-600{text-decoration-color:#c026d3}.decoration-gray-600{text-decoration-color:#4b5563}.decoration-green-600{text-decoration-color:#16a34a}.decoration-indigo-600{text-decoration-color:#4f46e5}.decoration-orange-600{text-decoration-color:#ea580c}.decoration-pink-600{text-decoration-color:#db2777}.decoration-purple-600{text-decoration-color:#9333ea}.decoration-rose-600{text-decoration-color:#e11d48}.decoration-sky-600{text-decoration-color:#0284c7}.decoration-teal-600{text-decoration-color:#0d9488}.decoration-violet-600{text-decoration-color:#7c3aed}.decoration-yellow-600{text-decoration-color:#ca8a04}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);box-shadow:0 0 transparent,0 0 transparent,0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);box-shadow:var(--tw-ring-offset-shadow,0 0 transparent),var(--tw-ring-shadow,0 0 transparent),var(--tw-shadow)}body{background:#131313}.nuxt-content-highlight{background:#181818;border-radius:4px;color:#d9d9d9;padding:14px}.language-text{background:#181818!important}.nuxt-content p code{background:#222;color:#d9d9d9}.nuxt-content p{text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:#d9d9d9;display:block;font-size:18px;font-style:normal;font-weight:400;letter-spacing:-.003em;line-height:28px;margin:1.56em 0 -.46em;word-break:break-word}.nuxt-content a{color:#999;-webkit-text-decoration:underline;text-decoration:underline}.nuxt-content a:hover{background:#333;color:#efefef}.nuxt-content ul{color:#d9d9d9;list-style-position:inside}.nuxt-content li{color:#d9d9d9;list-style-type:square}.nuxt-content h2{color:#fff;font-size:20px;font-weight:600}.nuxt-content h3,.nuxt-content h4{border-left:3px solid #333;color:#fff;font-size:18px;font-weight:600;padding-left:10px}pre{color:#fff!important;text-shadow:none!important}.token,pre{background:0 0!important}@media (min-width:768px){.md\:m-12{margin:3rem}.md\:my-3{margin-bottom:.75rem;margin-top:.75rem}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:p-12{padding:3rem}.md\:py-40{padding-bottom:10rem;padding-top:10rem}.md\:text-right{text-align:right}.md\:text-2xl{font-size:1.5rem;line-height:2rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}.md\:text-base{font-size:1rem;line-height:1.5rem}.md\:font-medium{font-weight:500}}code[class*=language-],pre[class*=language-]{background:0 0;color:#000;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal;word-wrap:normal;-webkit-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#b3d4fc;text-shadow:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#b3d4fc;text-shadow:none}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{background-color:#000;height:2px;left:0;opacity:1;position:fixed;right:0;top:0;transition:width .1s,opacity .4s;width:0;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}</style><link rel="preload" href="/_nuxt/static/1756687557/2024-04-04-exploring-state-in-jetpack-compose/state.js" as="script"><link rel="preload" href="/_nuxt/static/1756687557/2024-04-04-exploring-state-in-jetpack-compose/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1756687557/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><article class="m-4 md:m-12"><div class="grid md:grid-cols-2 gap-4"><div class="text-left font-medium text-white"><a href="https://umount.dev"><span class="inline-block py-1 px-3 rounded align-middle text-center bg-rose-600">↵</span> umount.dev</a></div> <div class="text-center md:text-right"></div></div> <header class="p-4 py-16 md:p-12 md:py-40 text-center text-white my-10 space-y-20"><div class="max-w-4xl mx-auto"><h1 class="text-xl md:text-4xl font-thin mb-4">Exploring State in Jetpack Compose</h1> <p class="md:font-medium text-sm md:text-base rounded inline-block p-1 px-4 bg-rose-600">Published April 4, 2024</p> <!----></div></header> <!----> <div class="max-w-2xl mx-auto space-y-6 nuxt-content"><p>I'm new to Jetpack Compose development and while I've been working reasonably productively on a Compose project I've found myself trusting in the magic of Compose in some places more than what I'm comfortable with in terms of my own knowledge.</p>
<p>So in this post I'm exploring more of how state works in Jetpack Compose.</p>
<p>Declarative UI shifts the UI development workflow from precedural step-by-step instructions on how to build and manipuilate what the user sees to modelling a state that when mutated will update the UI to reflect the change.</p>
<p>In Jetpack Compose, this is done with composable functions and in most cases <code>MutableState&lt;T></code>. We can however observe other types of state, as long as when we bind that state to our composable we do so as a <code>State&lt;T></code>. So although we may have other types we can use to model our state, such as LiveData and MutableStateFlows, at the point at which these types trigger a recomposition in Compose they're a <code>State&lt;T></code>; so for the purposes of this post, we can limit our scope to MutableState.</p>
<p>State is generally added to our composables using code similar to this:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-kotlin"><code><span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> greeting <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Hello"</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span>

    <span class="token function">Text</span><span class="token punctuation">(</span>
        text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">greeting</span></span><span class="token string">, World!"</span></span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Any change to <code>greeting</code> in the code above will trigger a recomposition of our <code>HelloWorld()</code> composable.</p>
<p>This post is really about exploring what happens in the single line of code <code>var greeting by remember { mutableStateOf("Hello")}</code> which we sometimes might see written with an <code>=</code> instead of <code>by</code>.</p>
<h2 id="the-difference-between--and-by-remember-mutablestateof"><a aria-hidden="true" href="#the-difference-between--and-by-remember-mutablestateof" tabindex="-1"><span class="icon icon-link"></span></a>The difference between <code>=</code> and <code>by</code> remember mutableStateOf</h2>
<p>The practical difference between <code>= remember</code> and <code>by remember</code> is that when you use <code>by</code> you no longer need to access the .value property of your variable explicitly. So <code>if (foo.value) { }</code> becomes simply <code>if (foo) {}</code> and our code becomes prettier and more concise.</p>
<p>For example:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-kotlin"><code><span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">FooBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> text <span class="token operator">=</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Foo"</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span>

    <span class="token function">Text</span><span class="token punctuation">(</span>
        text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Hello, would you like some </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">text<span class="token punctuation">.</span>value</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?"</span></span><span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">clickable</span> <span class="token punctuation">{</span>
            text<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Bar"</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Becomes:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-kotlin"><code><span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">FooBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> text <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Foo"</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span>

    <span class="token function">Text</span><span class="token punctuation">(</span>
        text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Hello, would you like some </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">text</span></span><span class="token string">?"</span></span><span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">clickable</span> <span class="token punctuation">{</span>
            text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Bar"</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Going past the visible code outcome and looking more into what's going on behind the scenes</p>
<p>When we move from:</p>
<p><code>val foo = remember { mutableStateOf("bar") }</code></p>
<p>To:</p>
<p><code>var foo by remember { mutableStateOf("bar") }</code></p>
<p>Changing <code>=</code> to <code>by</code> moves from an assignment to a property delegation. Property delegation is a Kotlin feature that delegates the getting and setting of a property to an intermediate object.</p>
<p>This is a cool feature of Kotlin and it's worth taking a moment to think about what's going on here. Above, we have to change <code>var</code> to <code>val</code>. At a first take this seems kind of unnecessary, if our delegate is a reference type why do we need to use a <code>var</code>?</p>
<p>It's because we're not actually assigning anything here. When we use <code>by</code> we're not assigning a delegate to <code>foo</code>, we're telling Kotlin there's a delegate somewhere we want to be <strong>responsible</strong> for <code>foo</code>.</p>
<p>It's easily understood when seeing what the Kotlin compiler does when we use <code>by</code>. If we write something like:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-kotlin"><code><span class="token keyword">class</span> FooBar <span class="token punctuation">{</span>
    <span class="token keyword">var</span> text<span class="token operator">:</span> String <span class="token keyword">by</span> <span class="token function">FooBarTextDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>The compiler will generate something like:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-kotlin"><code><span class="token keyword">class</span> FooBar <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> text$delegate <span class="token operator">=</span> <span class="token function">FooBarTextDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> text<span class="token operator">:</span> String
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> text$delegate<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">::</span>text<span class="token punctuation">)</span>
        <span class="token keyword">set</span><span class="token punctuation">(</span>value<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token operator">=</span> text$delegate<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">::</span>text<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>So our delegate gets stored in a private property <code>text$delegate</code> and our getters and setters call its <code>getValue</code> and <code>setValue</code> methods.</p>
<p>Our <code>MutableState</code> (returned by <code>mutableStateOf()</code>) delegate just redirects to the <code>value</code> property:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-kotlin"><code><span class="token keyword">inline</span> <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> MutableState<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>thisObj<span class="token operator">:</span> Any<span class="token operator">?</span><span class="token punctuation">,</span> property<span class="token operator">:</span> KProperty<span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">,</span> value<span class="token operator">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value
<span class="token punctuation">}</span>

<span class="token keyword">inline</span> <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> State<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>thisObj<span class="token operator">:</span> Any<span class="token operator">?</span><span class="token punctuation">,</span> property<span class="token operator">:</span> KProperty<span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token operator">=</span> value
</code></pre></div>
<h2 id="remembering-remember"><a aria-hidden="true" href="#remembering-remember" tabindex="-1"><span class="icon icon-link"></span></a>Remembering <code>remember</code></h2>
<p>Let's remember that <code>remember</code> is needed so our values will survive recomposition. If we rewrote our <code>FooBar</code> composable above and removed the <code>remember</code> whenever we tapped 'Foo' it would never change to 'Bar' because the update of our MutableState would cause a recomposition which would then ironically cause our value to be lost and set right back to 'Foo' on every tap.</p>
<p>Below is the source code for <code>remember</code>:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-swift"><code>inline fun <span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">></span> <span class="token function">remember</span><span class="token punctuation">(</span>crossinline calculation<span class="token punctuation">:</span> <span class="token attribute atrule">@DisallowComposableCalls</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name">T</span> <span class="token operator">=</span>
    currentComposer<span class="token punctuation">.</span><span class="token function">cache</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> calculation<span class="token punctuation">)</span>
</code></pre></div>
<p>So we can see when we call remember we lift the lambda out of the composable and onto the <code>cache</code> property on currentComposer.</p>
<p>For this to make sense we need to know that when you add the <code>@Composable</code> annotation to your composable function it rewrites it to accept a <code>Composer</code> parameter:</p>
<p>So</p>
<p><code>@Composable fun FooBar() {</code></p>
<p>becomes</p>
<p><code>fun FooBar($composer: Composer) {</code></p>
<p>The compiler also does the same for any call to a composable function within that function, which includes <code>remember</code>.</p>
<p>When recomposition happens, if we've used remember, the current Composer is passed back into our composable function and its remember function and we have access to our same value that was stored during initial composition again.</p>
<h2 id="wrapping-up"><a aria-hidden="true" href="#wrapping-up" tabindex="-1"><span class="icon icon-link"></span></a>Wrapping up</h2>
<p>Reading backwards through the line:</p>
<p><code>var foo by remember { mutableStateOf("Foo") }</code></p>
<p>from:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-kotlin"><code><span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">FooBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> text <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Foo"</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span>

    <span class="token function">Text</span><span class="token punctuation">(</span>
        text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Hello, would you like some </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">text</span></span><span class="token string">?"</span></span><span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">clickable</span> <span class="token punctuation">{</span>
            text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Bar"</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>On initial composition, we get a <code>MutableState</code> for our string <code>"Foo"</code> by calling <code>mutableStateOf</code></p>
<p>We store that in a lambda which <code>remember</code> adds to a cache on the Composer object that will be passed into it from its containing composable.</p>
<p>We create a delegate with <code>by</code> that makes our MutableState less verbose to work with.</p>
<p>When we change the value of our <code>MutableState</code> from <code>"Foo"</code> to <code>"Bar"</code> we trigger recomposition.</p>
<p>When our Composable is recompositioned the composer containing our lambda which contains our <code>MutableState</code> which now holds <code>"Bar"</code> instead of <code>"Foo"</code> is passed back into it and our <code>Text()</code> now shows <code>"Bar"</code> instead of <code>"Foo"</code> too, because our triggering <code>MutableState</code> was <code>remembered</code> instead of being recreated.</p>
<p>And while this semi-detailed account still skips over a lot of detail, that's essentially how our state is being handled in Compose.</p>
<p>Breaking it down this way has helped me understand the code I'm writing in Compose a lot better. If you've stumbled upon this post, I hope it's done the same for you – if not, soz mate.</p></div></article></div></div><script defer src="/_nuxt/static/1756687557/2024-04-04-exploring-state-in-jetpack-compose/state.js"></script><script src="/_nuxt/386cd7d.js" defer></script><script src="/_nuxt/be996ed.js" defer></script><script src="/_nuxt/43ca708.js" defer></script><script src="/_nuxt/3e08e2f.js" defer></script><script src="/_nuxt/3a249ae.js" defer></script>
  </body>
</html>
